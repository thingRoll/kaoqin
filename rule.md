开发考勤数据计算汇总工具，用此工具计算人员考勤信息时，根据人员所在的考勤组有针对性的考勤规则。每月按手动选择的模板，比如[模板-考勤.xlsx]根据手动选择的打卡源数据[数据来源-钉钉考勤导出报表_xxx-xxx.xlsx]的[原始记录]选项卡内容计算生成一份月度考勤表，规则如下：
#一、考勤组为“公司本部”：正常打卡时间08:30-17:30，晚上21:00以后打卡算加班0.5天，周末双休，国家法定节假日。
#二、考勤组非“公司本部”：每人每月4天的调休额度，多休扣存班，少休增加存班，存班在上一次生成的考勤计算表中读取。
#三、部门中包含“项目运维部”的人员独有的考勤规则：
##1、项目运维部-济宁运维项目：
###1.1、一天内（8:30-17:30），早上打卡，并且下午打卡，则这一天标记为上班，正常判断其迟到、早退和旷工。
###1.2、出现连续两天只有早上打卡，则第三天不打卡也标记为上班，连续两天只有早上打卡也标记为上班，因为这种情况下是值班人员，上24小时休48小时，这72小时就算上班。
###1.3、姓名为“刘淑亚”：一直白班（8:30-17:30），不会值班。
##2、项目运维部-绿地会展：上24小时休48小时，交接班时间：06:00
##3、项目运维部-邵寨煤业：马驰：长白班（8:30-17:30），其余三人三班倒，分早班（6:00-14:00）、中班（14:00-22：00）、晚班（22:00-次日6:00）
##4、项目运维部-南京紫金中心：长白班8:30-17:30
#四、其他规则：
##1、只有运维部和工程技术部门的员工才会计入工地天数，其他部门忽略此字段。
##2、数据来源表中已经计入了迟到次数中，则忽略旷工迟到次数，不能两边都计入，比如卜颖，数据源表“月度汇总”中实际迟到1次，旷工3次，旷工迟到次数1次，卜颖非运维部和工程技术部，所以不计入工地天数。
##3、打卡结果中存在外勤时，考勤表中对应的那天填写打卡地址的省市。
打卡地址：
包含“黄河国际会展中心”则考勤表中对应的那天填写“会展”，
包含“济宁大安机场”则考勤表中对应的那天填写“大安机场”，
包含“济宁文化中心”则考勤表中对应的那天填写“文化中心”，
包含“美年大健康”则考勤表中对应的那天填写“南京”，
包含“邵寨”则考勤表中对应的那天填写“邵寨”。
##4、补卡审批通过则视为已打卡
##5、调休半天时，分上午还是下午，填写“√/调休”或“调休/√”，比如“调休12-16 08:30到12-16 13:00 0.5天”，则填写“调休/√”
##6、外勤打卡，判断打卡地是省内还是省外，计入省内、省外。
#五、缩写与符号表示：
公司出勤：√、 周六周天休息：○、 法定节假日放假：※  请假：假 、病假：病假、 加班：+、 年假：年、 迟到：迟、 调休：调休、调休半天：√/调、 请假半天：√/假、 梁宝寺：梁 、郓：郓城、济：济宁、白：白庄、曲：曲阜、京：北京、博：博兴、聊：聊
#六、注意：
1、每个月的日期和星期以及日数都会不一样，所以每个月模板上都需要手动改动，日期应与手动选择的打卡源数据[数据来源-钉钉考勤导出报表_xxx-xxx.xlsx]的[原始记录]选项卡的第一行统计日期对应，系统要计算天数并验证模板上的天数与原始记录中的日期天数是否一致，不一致则弹出提示。
2、开发过程中，可以使用[模板-考勤.xlsx]作为模板，[数据来源-钉钉考勤导出报表_20251126-20251225.xlsx]作为考勤数据来源，[山东宜美科2025年11月份考勤.xlsx]作为手动完成后的考勤表用来验证工具生成的考勤表的正确性。
3、打包方法参考[打包.txt]
4、使用说明参考[使用说明.txt]
5、开发中的第一版代码，可以在此基础上开发[attendance.py]
#七、法定节假日的设置：
给出法定节假日设置页面，每年元旦前国务院办公厅会发布下一年的部分节假日安排的通知，包括各节假日的放假日期，以及放假调休日期，通过设置页面设置好各节假日的放假日期、放假调休日期及调休上班日期，保存到本地项目路径下，便于此工具的读取和存储使用。公司本部人员打卡是按照放假调休日期来计算，其他人员按照放假日期计算。比如2026年春节放假调休日期：2026.2.15—2026.2.23，添加调休上班日期1：2026.2.14，调休上班日期2：2026.2.28，2026年春节放假日期：2026.2.16—2026.2.19，共4天

补充内容：
1、第二阶段：“公司本部”定制化考勤（落实规则1）
如果员工属于“公司本部”考勤组，周末未打卡则自动判定为○，默认节假日未打卡为※。周末和节假日正常打卡则是正常按规则填写，算加班。

2、更正 第六阶段：迟到去重与工地天数限定（实现规则4.1,4.2,4.4）
当前缺陷：第241行直接将迟到和旷工迟到相加，造成了重复计算。
升级计划：
严格执行迟到去重：迟到、迟到旷工计入迟到。
识别出原始记录里的“补卡审批通过”，将其打卡重设为“正常”。
最后计算时，拦截部门不是“运维部”或“工程技术部”的人员，强制将其“工地天数”置为空或0。

3、法定节假日的设置：
给出法定节假日设置页面，每年元旦前国务院办公厅会发布下一年的部分节假日安排的通知，包括各节假日的放假日期，以及放假调休日期，通过设置页面设置好各节假日的放假日期、放假调休日期及调休上班日期，保存到本地项目路径下，便于此工具的读取和存储使用。公司本部人员打卡是按照放假调休日期来计算，其他人员按照放假日期计算。比如2026年春节放假调休日期：2026.2.15—2026.2.23，添加调休上班日期1：2026.2.14，调休上班日期2：2026.2.28，2026年春节放假日期：2026.2.16—2026.2.19，共4天。
公司考勤组，周末与节假日加班时，上午12点之前打卡上班即算做加班0.5天，下午打卡下班再算加班0.5天，上午下午均打卡则算加班1天，加班日没有迟到早退旷工等状态。
